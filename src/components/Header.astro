---
import {
  Home,
  Settings,
  Star,
  Users,
  Mail,
  Menu,
  X,
  Moon,
  Sun,
  Rocket,
} from "@lucide/astro";
import { Image } from "astro:assets";
import logo from "../assets/logo.png";

const navItems = [
  { name: "Inicio", href: "#inicio", icon: Home },
  { name: "Servicios", href: "#servicios", icon: Settings },
  { name: "Productos", href: "#productos", icon: Star },
  { name: "Nosotros", href: "#nosotros", icon: Users },
  { name: "Contacto", href: "#contacto", icon: Mail },
];
---

<header
  class="fixed top-0 left-0 right-0 z-50 border-b
         bg-[rgb(var(--surface-overlay))] dark:bg-[rgb(var(--surface-overlay))]
         border-[rgb(var(--border))] dark:border-[rgb(var(--border))]
         backdrop-blur-md shadow-sm dark:shadow-md transition-all duration-300"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <div class="flex items-center gap-2">
        <div
          class="inline-flex items-center justify-center rounded-lg transition-all duration-300
                 bg-white dark:bg-white shadow-sm dark:shadow-md"
        >
          <Image
            src={logo}
            alt="EmySoftware"
            width={80}
            height={80}
            class="rounded-md"
          />
        </div>
      </div>

      <nav class="hidden md:flex items-center gap-8">
        {
          navItems.map((item) => {
            const Icon = item.icon;
            return (
              <a
                href={item.href}
                class="flex items-center gap-2 text-sm font-medium 
                       text-[rgb(var(--text-muted))] dark:text-[rgb(var(--text-muted))]
                       hover:text-[rgb(var(--accent))] dark:hover:text-[rgb(var(--accent-strong))]
                       transition-colors duration-200"
              >
                <Icon class="w-5 h-5 text-[rgb(var(--text-primary))]" />
                {item.name}
              </a>
            );
          })
        }
      </nav>

      <div class="hidden md:flex items-center gap-4">
        <button
          id="theme-toggle"
          class="p-2 rounded-lg
                 bg-transparent hover:bg-[rgb(var(--surface-muted))]
                 dark:hover:bg-[rgb(var(--surface-muted))]
                 transition-all duration-200"
          aria-label="Cambiar tema"
        >
          <Moon
            id="moon-icon"
            class="w-5 h-5 dark:hidden text-[rgb(var(--text-primary))]"
          />
          <Sun
            id="sun-icon"
            class="w-5 h-5 hidden dark:block text-[rgb(var(--text-primary))]"
          />
        </button>

        <a
          href="#productos"
          class="inline-flex items-center gap-2 justify-center rounded-lg px-4 py-2.5 text-sm font-semibold text-white
                 bg-[linear-gradient(135deg,rgb(var(--accent)),rgb(var(--accent-strong)))]
                 hover:shadow-lg dark:hover:shadow-xl
                 hover:scale-105 active:scale-95
                 transition-all duration-200"
        >
          <Rocket class="w-5 h-5" />
          Ver Demo
        </a>
      </div>

      <button
        id="menu-btn"
        class="md:hidden p-2 rounded-lg
               hover:bg-[rgb(var(--surface-muted))] dark:hover:bg-[rgb(var(--surface-muted))]
               transition-all duration-200"
        aria-label="Abrir menÃº"
      >
        <Menu id="menu-open" class="w-6 h-6 text-[rgb(var(--text-primary))]" />
        <X
          id="menu-close"
          class="w-6 h-6 hidden text-[rgb(var(--text-primary))]"
        />
      </button>
    </div>
  </div>

  <div
    id="mobile-menu"
    class="hidden border-t border-[rgb(var(--border))]
           bg-[rgb(var(--surface-white))] dark:bg-[rgb(var(--surface-card))]
           md:hidden transition-all duration-300 shadow-lg dark:shadow-xl"
  >
    <nav class="flex flex-col px-4 py-4 space-y-3">
      {
        navItems.map((item) => {
          const Icon = item.icon;
          return (
            <a
              href={item.href}
              class="flex items-center gap-2 py-2 text-sm 
                     text-[rgb(var(--text-muted))] dark:text-[rgb(var(--text-muted))]
                     hover:text-[rgb(var(--accent))] dark:hover:text-[rgb(var(--accent-strong))]
                     transition-colors duration-200"
            >
              <Icon class="w-5 h-5 text-[rgb(var(--text-primary))]" />
              {item.name}
            </a>
          );
        })
      }

      <a
        href="#productos"
        class="mt-2 inline-flex items-center gap-2 justify-center rounded-lg px-4 py-2.5 text-sm font-semibold text-white
               bg-[linear-gradient(135deg,rgb(var(--accent)),rgb(var(--accent-strong)))]
               hover:shadow-lg dark:hover:shadow-xl transition-all duration-200"
      >
        <Rocket class="w-5 h-5" />
        Ver Demo
      </a>
    </nav>
  </div>
</header>

<script>
  const btn = document.getElementById("menu-btn");
  const menu = document.getElementById("mobile-menu");
  const openIcon = document.getElementById("menu-open");
  const closeIcon = document.getElementById("menu-close");

  btn?.addEventListener("click", () => {
    const isOpen = menu?.classList.toggle("hidden") === false;
    openIcon?.classList.toggle("hidden", isOpen);
    closeIcon?.classList.toggle("hidden", !isOpen);
  });

  const toggle = document.getElementById("theme-toggle");
  const root = document.documentElement;

  toggle?.addEventListener("click", () => {
    root.classList.toggle("dark");
  });
</script>
